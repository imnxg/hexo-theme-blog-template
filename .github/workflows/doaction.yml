
name: éƒ¨ç½²æ–‡æ¡£

on:
  push:
    branches:
      # ç¡®ä¿è¿™æ˜¯ä½ æ­£åœ¨ä½¿ç”¨çš„åˆ†æ”¯åç§°
      #- main  # ä¸»åˆ†æ”¯æœ‰ push è¡Œä¸ºæ—¶å°±è§¦å‘è¿™ä¸ª action
      - dev

jobs:
  deploy-gh-pages:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
      # æ‹‰å– github ä»“åº“ä»£ç 
        uses: actions/checkout@v4
        with:
         # â€œæœ€è¿‘æ›´æ–°æ—¶é—´â€ ç­‰ git æ—¥å¿—ç›¸å…³ä¿¡æ¯ï¼Œéœ€è¦æ‹‰å–å…¨éƒ¨æäº¤è®°å½•
          fetch-depth: 0
          # å¦‚æœä½ æ–‡æ¡£éœ€è¦ Git å­æ¨¡å—ï¼Œå–æ¶ˆæ³¨é‡Šä¸‹ä¸€è¡Œ
          # submodules: true

      # è®¾å®š node ç¯å¢ƒ
      - name: è®¾ç½® Node.js
        uses: actions/setup-node@v4
        with:
         # é€‰æ‹©è¦ä½¿ç”¨çš„ node ç‰ˆæœ¬
          # node-version: ${{ matrix.node-version }}
          node-version: 20.7.0
          # è®¾ç½®å‘åŒ… npm åœ°å€ä»“åº“
          registry-url: https://registry.npmjs.org
          # ç¼“å­˜ npm ä¾èµ–
          cache: npm
      # å®‰è£…ä¾èµ–ï¼Œç›¸å½“äº npm ci
      - name: Install dependencies ğŸ“¦ï¸
        run: npm install
        
      # æ‰§è¡Œæ„å»ºæ­¥éª¤
      # è¿è¡Œæ„å»ºè„šæœ¬
      - name: æ„å»ºæ–‡æ¡£
        env:
          NODE_OPTIONS: --max_old_space_size=8192
        run: |-
          npm run build
        #  > dist/.nojekyll
        #  > src/.vuepress/dist/.nojekyll

      # æŸ¥çœ‹ workflow çš„æ–‡æ¡£æ¥è·å–æ›´å¤šä¿¡æ¯
      # @see https://github.com/crazy-max/ghaction-github-pages
      - name: éƒ¨ç½²åˆ°Github
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          token: ${{ secrets.HEXO_DEPLOY }}
          repository-name: xxx/xxx.github.io # å…¬å…±ä»“åº“ï¼Œæ ¼å¼ï¼šGitHub ç”¨æˆ·å/ä»“åº“å
          branch: gh-pages  # åˆ†æ”¯ï¼Œå¡« gh-pages å°±è¡Œ
          folder: ./public # éƒ¨ç½² public ç›®å½•ä¸‹çš„æ–‡ä»¶


